---
/**
 * Product detail: large image, Urdu verse, size selector, Add to cart.
 * Uses getStaticPaths for static generation from products.json.
 */
import BaseLayout from '../../layouts/BaseLayout.astro';
import AddToCart from '../../components/product/AddToCart';
import products from '../../data/products.json';

export function getStaticPaths() {
  return products.map((p) => ({ params: { slug: p.slug } }));
}

const { slug } = Astro.params;
const product = products.find((p) => p.slug === slug);

if (!product) {
  return Astro.redirect('/shop');
}
---

<BaseLayout title={`${product.name} — Adab`} description={product.description}>
  <article class="max-w-6xl mx-auto px-4 sm:px-6 py-10 md:py-14">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 lg:gap-16">
      <div class="aspect-[3/4] overflow-hidden rounded-lg bg-sand dark:bg-charcoal-light shadow-soft">
        <img
          src={product.image}
          alt={product.name}
          class="w-full h-full object-cover"
        />
      </div>
      <div class="flex flex-col">
        <h1 class="font-display text-3xl md:text-4xl text-ink dark:text-cream">{product.name}</h1>
        <p class="mt-4 text-emerald font-medium">
          {product.currency} {product.price.toLocaleString()}
        </p>

        <!-- Urdu verse as design element — RTL, prominent -->
        <div class="mt-8 p-6 rounded-lg bg-sand/50 dark:bg-charcoal-light/50 border border-sand dark:border-charcoal-light">
          <p class="urdu-text text-xl md:text-2xl text-charcoal dark:text-cream leading-loose font-urdu">
            {product.urduVerse}
          </p>
          <p class="mt-3 text-charcoal/70 dark:text-cream/70 text-sm italic">
            {product.urduVerseTransliteration}
          </p>
        </div>

        <p class="mt-6 text-charcoal/90 dark:text-cream/90 leading-relaxed">
          {product.description}
        </p>

        <AddToCart
          client:load
          productId={product.id}
          name={product.name}
          slug={product.slug}
          price={product.price}
          currency={product.currency}
          image={product.image}
          sizes={product.sizes}
        />
      </div>
    </div>
  </article>
</BaseLayout>
