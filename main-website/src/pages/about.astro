---
/**
 * About: content from site settings (admin-editable). Falls back to defaults if API unavailable.
 */
import BaseLayout from '../layouts/BaseLayout.astro';

const baseUrl = (import.meta.env.PUBLIC_API_URL || 'http://localhost:3000').toString().replace(/\/$/, '');
let aboutTitle = 'Wear the words';
let aboutSubtitle = 'Where adab meets the street.';
let aboutContent = '';

try {
  const res = await fetch(`${baseUrl}/settings/public`);
  const json = await res.json();
  if (json?.success && json?.data?.about) {
    const a = json.data.about;
    if (a.title) aboutTitle = a.title;
    if (a.subtitle) aboutSubtitle = a.subtitle;
    if (a.content) aboutContent = a.content;
  }
} catch {
  // use defaults above
}

// Fallback static content if no HTML from settings
const fallbackContent = `
  <p>Adab is more than etiquette — it's the art of how we speak, how we listen, and how we carry ourselves.
  In Urdu literature, adab runs through every line of verse, every gathering at a mushaira, every moment
  when a poet picks up the pen. We wanted to bring that soul into what you wear.</p>
  <p>Our pieces are inspired by classical Urdu poetry: the ghazal, the nazm, the couplets that have moved
  generations. Each design carries a verse — sometimes loud on the chest, sometimes tucked in like a
  secret. The words are in Nastaliq, in script that feels like breath on paper.</p>
  <p>We're not a fashion label that uses Urdu as a trend. We're a label that starts from the verse.
  From the culture of mehfils and mushairas, from the weight of a single word. Streetwear that
  doesn't shout — it speaks.</p>
  <p class="urdu-text font-urdu text-2xl md:text-3xl text-ink dark:text-cream text-right leading-loose mt-16 py-10 border-t border-b border-sand dark:border-charcoal-light">الفاظ سے پہلے آداب سیکھو</p>
  <p class="text-charcoal/70 dark:text-cream/70 text-sm italic">Alfaaz se pehle adaab seekho — Before words, learn adab.</p>
  <p>Thank you for wearing the words with us. For carrying a little bit of adab into your day.</p>
`;
const displayContent = aboutContent.trim() || fallbackContent;
---

<BaseLayout title="About — Adab" description="The story behind Adab — Urdu poetry and adab on streetwear.">
  <article class="max-w-3xl mx-auto px-4 sm:px-6 py-14 md:py-22">
    <header class="mb-14">
      <h1 class="font-display text-4xl md:text-5xl text-ink dark:text-cream leading-tight">
        {aboutTitle}
      </h1>
      <p class="mt-4 text-xl text-charcoal/80 dark:text-cream/80 font-display">
        {aboutSubtitle}
      </p>
    </header>

    <div class="space-y-10 text-charcoal/90 dark:text-cream/90 leading-relaxed about-content" set:html={displayContent} />

    <div class="mt-14">
      <a href="/shop" class="inline-block text-emerald hover:text-emerald-light font-medium transition-colors">
        Explore the collection →
      </a>
    </div>
  </article>
</BaseLayout>
